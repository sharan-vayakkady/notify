name: Merge Conflict Check

on:
  pull_request:
    branches:
      - main
      - staging

jobs:
  merge_conflict_check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Merge Conflict Check
        run: |
          chmod +x merge_conflict_check.sh
          ./merge_conflict_check.sh

      - name: Notify Slack
      env:
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
      if test = 5
      run: |
        curl -X POST -H 'Content-type: application/json' --data '{
          "text": "Merge conflict ditected.\n\nRepository: ${{ github.repository }}\nTitle: ${{ github.event.pull_request.title }}\nAuthor: ${{ github.event.pull_request.user.login }}\nURL: ${{ github.event.pull_request.html_url }}"
        }' $SLACK_WEBHOOK_URL
      else 
      curl -X POST -H 'Content-type: application/json' --data '{
          "text": "no conflict.\n\nRepository: ${{ github.repository }}\nTitle: ${{ github.event.pull_request.title }}\nAuthor: ${{ github.event.pull_request.user.login }}\nURL: ${{ github.event.pull_request.html_url }}"
        }' $SLACK_WEBHOOK_URL
       
